<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>PureClean</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="assets/images/icon/favicon.ico">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/metisMenu.css">
    <link rel="stylesheet" href="assets/css/slicknav.min.css">
    <link rel="stylesheet" href="assets/css/jquery.toast.min.css">
    <!-- others css -->
    <link rel="stylesheet" href="assets/css/typography.css">
    <link rel="stylesheet" href="assets/css/default-css.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <link rel="stylesheet" href="assets/css/bootstrap-datepicker3.standalone.min.css">
    <!-- modernizr css -->
    <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>
</head>

<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <!-- preloader area start -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <a class="navbar-brand" href="/eccctools">
                    <span><i class="wi wi-sunset"></i> EC<sup>3</sup> Tools</span>
                </a>
            </div>
            <div class="main-menu">
                <div class="menu-inner">
                    <nav>
                        <ul class="metismenu" id="menu">
                            <li class="active">
                                <a href="javascript:void(0)" aria-expanded="true"><i class="ti-desktop"></i><span>PureCloud Utilities</span></a>
                                <ul class="collapse">
                                    <li><a href="index.html">PureClean</a></li>
                                    <li class="active"><a href="aeupsell.html">AE Upsell</a></li>
                                </ul>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-6 col-sm-8 clearfix">
                        <div class="nav-btn pull-left">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                    <!-- profile info & task notification -->
                    <div class="col-md-6 col-sm-4 clearfix">
                        <ul class="notification-area pull-right">
                            <li id="full-view"><i class="ti-fullscreen"></i></li>
                            <li id="full-view-exit"><i class="ti-zoom-out"></i></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- header area end -->
            <!-- page title area start -->
            <div class="page-title-area">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <div class="breadcrumbs-area clearfix">
                            <h4 class="page-title pull-left">AE Upsell</h4>
                            <ul class="breadcrumbs pull-left">
                                <li><a href="index.html">Home</a></li>
                                <li><span class="active">AE Upsell</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- page title area end -->
            <div class="main-content-inner">
                <div class="mt-5 mb-5 card card-bordered">
                    <div class="card-body text-center">
                        <p>Get insightful statistics about any PureCloud organization</p>
                        <p>Useful to check if PureCloud customers are using specific features or functionalities</p>
                    </div>
                </div>
                <div class="mt-5 mb-5 card card-bordered">
                    <div class="card-body">
                        <h4 class="header-title">PureCloud Connection</h4>
                        <small class="form-text text-muted">Populate all fields below then click on <code>Connect</code></small><br />
                        <div class="form-group">
                            <label for="clientId">Client Id</label>
                            <input type="text" class="form-control" id="clientId" placeholder="Enter your client id">
                        </div>
                        <div class="form-group">
                            <label for="clientSecret">Client Secret</label>
                            <input type="password" class="form-control" id="clientSecret" placeholder="Enter your client secret">
                        </div>
                        <div class="form-group">
                            <label for="environment">PureCloud Environment</label>
                            <select class="form-control" id="environment">
                                <option value="mypurecloud.ie" selected>mypurecloud.ie (Ireland)</option>
                                <option value="mypurecloud.com">mypurecloud.com (US)</option>
                                <option value="mypurecloud.de">mypurecloud.de (Germany)</option>
                                <option value="mypurecloud.com.au">mypurecloud.com.au (Australia/New Zealand)</option>
                                <option value="mypurecloud.jp">mypurecloud.jp (Japan)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="startDate">Start Date</label><small> (limited to the past 7 days)</small>
                            <input data-provide="datepicker" class="form-control" id="startDate">
                        </div>
                        <div class="form-group">
                            <label for="duration">Duration</label><small> (max = 7 days)</small>
                            <input type="number" class="form-control" min="1" max="7" id="duration" value="1">
                        </div>
                        <div class="form-group">
                            <label for="emailAddress">Email Address</label>
                            <input type="email" class="form-control" id="emailAddress" placeholder="Enter your email address so we can let you know when the report is ready">
                        </div>
                        <div class="float-right">
                            <button id="testConnection" type="button" class="btn btn-info">Test Connection</button>
                            <button id="submitRequest" disabled type="submit" class="btn btn-primary">Submit Request</button>
                        </div>
                    </div>
                </div>
                <div class="mt-5 mb-5 card card-bordered" id="pureCloudObjects">
                    <div class="card-body">
                        <h4 class="header-title">PureCloud Objects</h4>
                        <small class="text-muted">Click on an object category to view all objects for that category</small>
                        <button id="refresh-all" type="button" class="btn btn-info">Refresh All Objects</button>
                        <div id="purecloudaccordion" class="accordion accordion-s3 mt-3">
                            <!-- Users -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudusersaccordion"><i class="ti-angle-right"></i> Users</a>
                                </div>
                                <div id="purecloudusersaccordion" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-users" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-users" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-users" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Users</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-users checkbox" name="select-all-users" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                    <th class="danger">Email Address</th>
                                                </tr>
                                            </thead>
                                            <tbody id="users">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Queues -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-queues"><i class="ti-angle-right"></i> Queues</a>
                                </div>
                                <div id="purecloudaccordion-queues" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-queues" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-queues" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-queues" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Queues</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-queues checkbox" name="select-all-queues" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="queues">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Skills -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-skills"><i class="ti-angle-right"></i> Skills</a>
                                </div>
                                <div id="purecloudaccordion-skills" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-skills" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-skills" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-skills" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Skills</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-skills checkbox" name="select-all-skills" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="skills">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Flows -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-flows"><i class="ti-angle-right"></i> Flows (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-flows" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-flows" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-flows" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-flows" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Flows</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-flows checkbox" name="select-all-flows" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="flows">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Presence Definitions -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-presenceDefinitions"><i class="ti-angle-right"></i> Custom Presence Definitions (Custom Statuses)</a>
                                </div>
                                <div id="purecloudaccordion-presenceDefinitions" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-presenceDefinitions" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-presenceDefinitions" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-presenceDefinitions" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Presence Definitions</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-presenceDefinitions checkbox" name="select-all-presenceDefinitions" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="presenceDefinitions">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Wrap Up Codes -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-wrapupcodes"><i class="ti-angle-right"></i> Wrap Up Codes</a>
                                </div>
                                <div id="purecloudaccordion-wrapupcodes" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-wrapupcodes" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-wrapupcodes" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-wrapupcodes" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Wrap Up Codes</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-wrapupcodes checkbox" name="select-all-wrapupcodes" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="wrapupcodes">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Outbound Campaigns -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-outboundCampaigns"><i class="ti-angle-right"></i> Outbound Campaigns</a>
                                </div>
                                <div id="purecloudaccordion-outboundCampaigns" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-outboundCampaigns" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-outboundCampaigns" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-outboundCampaigns" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Outbound Campaigns</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-outboundCampaigns checkbox" name="select-all-outboundCampaigns" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="outboundCampaigns">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scripts -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-scripts"><i class="ti-angle-right"></i> Scripts</a>
                                </div>
                                <div id="purecloudaccordion-scripts" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-scripts" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-scripts" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-scripts" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Scripts</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-scripts checkbox" name="select-all-scripts" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="scripts">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Web Chat Deployments -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-webChatDeployments"><i class="ti-angle-right"></i> Web Chat Deployments</a>
                                </div>
                                <div id="purecloudaccordion-webChatDeployments" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-webChatDeployments" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-webChatDeployments" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-webChatDeployments" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Web Chat Deployments</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-webChatDeployments checkbox" name="select-all-webChatDeployments" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="webChatDeployments">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Recordings -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-recordings"><i class="ti-angle-right"></i> Recordings (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-recordings" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-recordings" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-recordings" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-recordings" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Recordings</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-recordings checkbox" name="select-all-recordings" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="recordings">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Divisions -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-divisions"><i class="ti-angle-right"></i> Divisions (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-divisions" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-divisions" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-divisions" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-divisions" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Divisions</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-divisions checkbox" name="select-all-divisions" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="divisions">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Data Actions -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-dataactions"><i class="ti-angle-right"></i> Published Data Actions</a>
                                </div>
                                <div id="purecloudaccordion-dataactions" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-dataactions" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-dataactions" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-dataactions" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Data Actions</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-dataactions checkbox" name="select-all-dataactions" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="dataactions">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- main content area end -->
        <!-- footer area start-->
        <footer>
            <div class="footer-area">
                <p>© Copyright 2019. All rights reserved.</p>
            </div>
        </footer>
        <!-- footer area end-->
    </div>
    <!-- page container area end -->

    <!-- jquery latest version -->
    <script src="assets/js/vendor/jquery-2.2.4.min.js"></script>

    <!-- bootstrap 4 js -->
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/metisMenu.min.js"></script>
    <script src="assets/js/jquery.slimscroll.min.js"></script>
    <script src="assets/js/jquery.slicknav.min.js"></script>

    <!-- jQuery Toast -->
    <script src="assets/js/jquery.toast.min.js"></script>

    <!-- others plugins -->
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/scripts.js"></script>
    <script src="assets/js/bootstrap-datepicker.min.js"></script>

    <!-- This page's scripts -->
    <script src="assets/js/aws.js"></script>
    <script src="assets/js/notifications.js"></script>
    <script src="assets/js/mail.js"></script>

    <script>

        // Init
        $("#pureCloudObjects").hide();

        // Initialize DatePicker control (https://bootstrap-datepicker.readthedocs.io/en/latest/)
        $("#startDate").datepicker({
            format: "yyyy/mm/dd",
            startDate: "-6d",     // Limit to today and the last 6 days
            endDate: "+0d",       // No future dates
            autoclose: true,      // Close after selecting date
            weekStart: 1          // weeks start on Mondays
        });

        // Generate a UUID
        function uuidv4() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
                var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        // Submit Request
        $("#submitRequest").click(() => {
            var clientId = $("#clientId").val();
            var clientSecret = $("#clientSecret").val();
            var environment = $("#environment").children("option:selected").val();
            var startDate = $("#startDate").val();
            var duration = $("#duration").val();
            var emailAddress = $("#emailAddress").val();
            var uuid = uuidv4();

            if (!emailAddress) {
                showMessage("Invalid email address", true);
                return;
            }

            console.log('Submitting Request...');
            console.log(`client id: ${clientId}`);
            console.log(`environment: ${environment}`);
            console.log(`start date: ${startDate}`);
            console.log(`duration: ${duration}`);
            console.log(`email address: ${emailAddress}`);
            console.log(`task id: ${uuid}`);

            submitRequest(clientId, clientSecret, environment, startDate, duration, emailAddress, uuid)
                .then((token) => {
                    showMessage("Request submitted. Thank you!");
                    sendEmail(emailAddress, "Your AE Upsell Task", "Thank you for using the AE Upsell tool. When ready, your data will be available here: https://pierricki3.github.io/eccctools/aeupsellrequests.html?taskId=" + uuid).then((response) => {
                        console.log(response);
                    }).catch((error) => {
                        showMessage("Failed to send email", true);
                    });
                }).catch((error) => {
                    showMessage(error, true);
                });
        });

        // Test PureCloud Connection Button
        $("#testConnection").click(() => {
            connectToPureCloud($("#clientId").val(), $("#clientSecret").val(), $("#environment").children("option:selected").val())
                .then((token) => {
                    $("#submitRequest").removeAttr("disabled");
                    showMessage("Click on Submit Request to continue...");
                }).catch((error) => {
                    $("#submitRequest").attr("disabled", true);
                    console.error(error);
                    showMessage(error, true);
                });
        });

    </script>
</body>

</html>