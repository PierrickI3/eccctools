<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>PureClean</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="assets/images/icon/favicon.ico">
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="assets/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/themify-icons.css">
    <link rel="stylesheet" href="assets/css/metisMenu.css">
    <link rel="stylesheet" href="assets/css/slicknav.min.css">
    <link rel="stylesheet" href="assets/css/jquery.toast.min.css">
    <!-- others css -->
    <link rel="stylesheet" href="assets/css/typography.css">
    <link rel="stylesheet" href="assets/css/default-css.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/responsive.css">
    <!-- modernizr css -->
    <script src="assets/js/vendor/modernizr-2.8.3.min.js"></script>
</head>

<body>
    <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->
    <!-- preloader area start -->
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <!-- preloader area end -->
    <!-- page container area start -->
    <div class="page-container">
        <!-- sidebar menu area start -->
        <div class="sidebar-menu">
            <div class="sidebar-header">
                <a class="navbar-brand" href="/eccctools">
                    <span><i class="wi wi-sunset"></i> EC<sup>3</sup> Tools</span>
                </a>
            </div>
            <div class="main-menu">
                <div class="menu-inner">
                    <nav>
                        <ul class="metismenu" id="menu">
                            <li class="active">
                                <a href="javascript:void(0)" aria-expanded="true"><i class="ti-desktop"></i><span>PureCloud Utilities</span></a>
                                <ul class="collapse">
                                    <li class="active"><a href="index.html">PureClean</a></li>
                                </ul>
                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>
        <!-- sidebar menu area end -->
        <!-- main content area start -->
        <div class="main-content">
            <!-- header area start -->
            <div class="header-area">
                <div class="row align-items-center">
                    <!-- nav and search button -->
                    <div class="col-md-6 col-sm-8 clearfix">
                        <div class="nav-btn pull-left">
                            <span></span>
                            <span></span>
                            <span></span>
                        </div>
                    </div>
                    <!-- profile info & task notification -->
                    <div class="col-md-6 col-sm-4 clearfix">
                        <ul class="notification-area pull-right">
                            <li id="full-view"><i class="ti-fullscreen"></i></li>
                            <li id="full-view-exit"><i class="ti-zoom-out"></i></li>
                        </ul>
                    </div>
                </div>
            </div>
            <!-- header area end -->
            <!-- page title area start -->
            <div class="page-title-area">
                <div class="row align-items-center">
                    <div class="col-sm-6">
                        <div class="breadcrumbs-area clearfix">
                            <h4 class="page-title pull-left">PureClean</h4>
                            <ul class="breadcrumbs pull-left">
                                <li><a href="index.html">Home</a></li>
                                <li><span class="active">PureClean</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- page title area end -->
            <div class="main-content-inner">
                <div class="mt-5 mb-5 card card-bordered">
                    <div class="card-body text-center">
                        <p>Clean any of your PureCloud organizations by selecting users/queues/flows/etc. and deleting them.</p>
                        <p>Useful if you run trials from your dev orgs</p>
                        <p><i>Flows are not yet available as it requires more work</i></p>
                    </div>
                </div>
                <div class="mt-5 mb-5 card card-bordered">
                    <div class="card-body">
                        <h4 class="header-title">PureCloud Connection</h4>
                        <small class="form-text text-muted">Populate all fields below then click on <code>Connect</code></small><br />
                        <div class="form-group">
                            <label for="clientId">Client Id</label>
                            <input type="text" class="form-control" id="clientId" placeholder="Enter your client id">
                        </div>
                        <div class="form-group">
                            <label for="clientSecret">Client Secret</label>
                            <input type="password" class="form-control" id="clientSecret" placeholder="Enter your client secret">
                        </div>
                        <div class="form-group">
                            <label for="environment">PureCloud Environment</label>
                            <select class="form-control" id="environment">
                                <option value="mypurecloud.ie" selected>mypurecloud.ie (Ireland)</option>
                                <option value="mypurecloud.com">mypurecloud.com (US)</option>
                                <option value="mypurecloud.de">mypurecloud.de (Germany)</option>
                                <option value="mypurecloud.com.au">mypurecloud.com.au (Australia/New Zealand)</option>
                                <option value="mypurecloud.jp">mypurecloud.jp (Japan)</option>
                            </select>
                        </div>
                        <div>
                            <button id="connect" type="button" class="btn btn-primary"><i class="ti-unlock"></i> Connect</button>
                        </div>

                    </div>
                </div>
                <div class="mt-5 mb-5 card card-bordered" id="pureCloudObjects">
                    <div class="card-body">
                        <h4 class="header-title">PureCloud Objects</h4>
                        <small class="text-muted">Click on an object category to view all objects for that category</small>
                        <button id="refresh-all" type="button" class="btn btn-info">Refresh All Objects</button>
                        <div id="purecloudaccordion" class="accordion accordion-s3 mt-3">
                            <!-- Users -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudusersaccordion"><i class="ti-angle-right"></i> Users</a>
                                </div>
                                <div id="purecloudusersaccordion" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-users" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-users" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-users" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Users</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-users checkbox" name="select-all-users" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                    <th class="danger">Email Address</th>
                                                </tr>
                                            </thead>
                                            <tbody id="users">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Queues -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-queues"><i class="ti-angle-right"></i> Queues</a>
                                </div>
                                <div id="purecloudaccordion-queues" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-queues" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-queues" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-queues" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Queues</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-queues checkbox" name="select-all-queues" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="queues">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Skills -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-skills"><i class="ti-angle-right"></i> Skills</a>
                                </div>
                                <div id="purecloudaccordion-skills" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-skills" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-skills" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-skills" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Skills</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-skills checkbox" name="select-all-skills" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="skills">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Flows -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-flows"><i class="ti-angle-right"></i> Flows (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-flows" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-flows" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-flows" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-flows" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Flows</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-flows checkbox" name="select-all-flows" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="flows">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Presence Definitions -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-presenceDefinitions"><i class="ti-angle-right"></i> Custom Presence Definitions (Custom Statuses)</a>
                                </div>
                                <div id="purecloudaccordion-presenceDefinitions" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-presenceDefinitions" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-presenceDefinitions" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-presenceDefinitions" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Presence Definitions</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-presenceDefinitions checkbox" name="select-all-presenceDefinitions" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="presenceDefinitions">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Wrap Up Codes -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-wrapupcodes"><i class="ti-angle-right"></i> Wrap Up Codes</a>
                                </div>
                                <div id="purecloudaccordion-wrapupcodes" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-wrapupcodes" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-wrapupcodes" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-wrapupcodes" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Wrap Up Codes</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-wrapupcodes checkbox" name="select-all-wrapupcodes" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="wrapupcodes">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Outbound Campaigns -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-outboundCampaigns"><i class="ti-angle-right"></i> Outbound Campaigns</a>
                                </div>
                                <div id="purecloudaccordion-outboundCampaigns" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-outboundCampaigns" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-outboundCampaigns" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-outboundCampaigns" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Outbound Campaigns</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-outboundCampaigns checkbox" name="select-all-outboundCampaigns" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="outboundCampaigns">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Scripts -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-scripts"><i class="ti-angle-right"></i> Scripts</a>
                                </div>
                                <div id="purecloudaccordion-scripts" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-scripts" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-scripts" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-scripts" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Scripts</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-scripts checkbox" name="select-all-scripts" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="scripts">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Web Chat Deployments -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-webChatDeployments"><i class="ti-angle-right"></i> Web Chat Deployments</a>
                                </div>
                                <div id="purecloudaccordion-webChatDeployments" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-webChatDeployments" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-webChatDeployments" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-webChatDeployments" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Web Chat Deployments</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-webChatDeployments checkbox" name="select-all-webChatDeployments" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="webChatDeployments">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Recordings -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-recordings"><i class="ti-angle-right"></i> Recordings (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-recordings" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-recordings" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-recordings" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-recordings" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Recordings</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-recordings checkbox" name="select-all-recordings" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="recordings">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                            <!-- Divisions -->
                            <div class="card mb-3">
                                <div class="card-header">
                                    <a class="btn btn-link" data-toggle="collapse" href="#purecloudaccordion-divisions"><i class="ti-angle-right"></i> Divisions (N/A)</a>
                                </div>
                                <!-- <div id="purecloudaccordion-divisions" class="collapse" data-parent="#purecloudaccordion">
                                    <div class="card-body">
                                        <button id="select-all-divisions" class="btn button-default mr-2">Select/Deselect All</button>
                                        <button id="select-invert-divisions" class="btn button-default mr-2">Invert Selection</button>
                                        <button id="delete-divisions" disabled type="button" class="btn btn-danger"><i class="ti-trash"></i> Delete Selected Divisions</button>
                                        <table class="table table-striped table-hover table-sm">
                                            <thead>
                                                <tr>
                                                    <th class="active">
                                                        <input type="checkbox" class="select-all-divisions checkbox" name="select-all-divisions" />
                                                    </th>
                                                    <th class="success">Id</th>
                                                    <th class="warning">Name</th>
                                                </tr>
                                            </thead>
                                            <tbody id="divisions">
                                            </tbody>
                                        </table>
                                        <div class="mt-5">
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- main content area end -->
        <!-- footer area start-->
        <footer>
            <div class="footer-area">
                <p>© Copyright 2019. All rights reserved.</p>
            </div>
        </footer>
        <!-- footer area end-->
    </div>
    <!-- page container area end -->
    <!-- jquery latest version -->
    <script src="assets/js/vendor/jquery-2.2.4.min.js"></script>
    <!-- bootstrap 4 js -->
    <script src="assets/js/popper.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl.carousel.min.js"></script>
    <script src="assets/js/metisMenu.min.js"></script>
    <script src="assets/js/jquery.slimscroll.min.js"></script>
    <script src="assets/js/jquery.slicknav.min.js"></script>

    <!-- jQuery Toast -->
    <script src="assets/js/jquery.toast.min.js"></script>
    <!-- others plugins -->
    <script src="assets/js/plugins.js"></script>
    <script src="assets/js/scripts.js"></script>
    <!-- This page's scripts -->
    <script src="assets/js/aws.js"></script>
    <script src="assets/js/notifications.js"></script>

    <script>

        // Init
        $("#pureCloudObjects").hide();

        // Connect to PureCloud Button
        $("#connect").click(() => {
            connectToPureCloud($("#clientId").val(), $("#clientSecret").val(), $("#environment").children("option:selected").val())
                .then((token) => {
                    $("#pureCloudObjects").show();
                    showMessage("Connected to PureCloud");
                    showMessage("Please wait while all objects are retrieved...");
                    loadObjects();
                }).catch((error) => {
                    console.error(error);
                    showMessage(error, true);
                });
        });

        //#region Generic functions

        $("#refresh-all").click(function () {
            loadObjects();
        });

        function loadObjects() {
            // Load Users
            getItems("users").then((users) => {
                console.log("Users:", users);
                populateTable("users", users);
            });
            getItems("queues").then((queues) => {
                console.log("Queues:", queues);
                populateTable("queues", queues);
            });
            getItems("skills").then((skills) => {
                console.log("Skills:", skills);
                populateTable("skills", skills);
            });
            // getItems("flows").then((flows) => {
            //     console.log("Flows:", flows);
            //     populateTable("flows", flows);
            // });
            getItems("presenceDefinitions").then((presenceDefinitions) => {
                console.log("Presence Definitions:", presenceDefinitions);
                //TODO Remove primary statuses
                populateTable("presenceDefinitions", presenceDefinitions);
            });
            getItems("wrapupcodes").then((wrapupcodes) => {
                console.log("Wrap Up Codes:", wrapupcodes);
                populateTable("wrapupcodes", wrapupcodes);
            });
            getItems("outboundCampaigns").then((outboundCampaigns) => {
                console.log("Outbound Campaigns:", outboundCampaigns);
                populateTable("outboundCampaigns", outboundCampaigns);
            });
            getItems("scripts").then((scripts) => {
                console.log("Scripts:", scripts);
                populateTable("scripts", scripts);
            });
            getItems("webChatDeployments").then((webChatDeployments) => {
                console.log("Web Chat Deployments:", webChatDeployments);
                populateTable("webChatDeployments", webChatDeployments);
            });
            // getItems("recordings").then((flows) => {
            //     console.log("Recordings:", recordings);
            //     populateTable("recordings", recordings);
            // });
            // getItems("divisions").then((flows) => {
            //     console.log("Divisions:", divisions);
            //     populateTable("divisions", divisions);
            // });
        }

        function populateTable(tableName, items) {
            $("#" + tableName).empty();
            $.each(items, (i, item) => {
                //console.log("Adding", item);
                var row = $("<tr />").appendTo("#" + tableName);

                // Checkbox
                var checkItem = $("<td />", { class: "active" }).appendTo(row);
                $("<input />", { type: "checkbox", class: "select-item-" + tableName + " checkbox", name: "select-item-" + tableName }).val(item.id).appendTo(checkItem);

                // Id Column
                $("<td />").text(item.id).appendTo(row);

                // Name Column
                if (item.hasOwnProperty("name")) {
                    $("<td />").text(item.name).appendTo(row);
                } else if (item.hasOwnProperty("systemPresence")) {
                    $("<td />").text(`${item.systemPresence} (${item.languageLabels.en_US})`).appendTo(row);
                }

                // Email Address Column
                if (item.hasOwnProperty("email")) {
                    $("<td />").text(item.email).appendTo(row);
                }
            });

            //check selected items
            $("input.select-item-" + tableName).click(function () {
                var checked = this.checked;
                checkSelectedItems(tableName);
            });
        }

        function getSelectedItems(type) {
            var items = [];
            $("input.select-item-" + type + ":checked:checked").each(function (index, item) {
                items[index] = item.value;
            });
            return items;
        }

        // Enable/Disable Delete Button
        function updateButtonStatus(button, itemsControl) {
            var len = $(itemsControl + ":checked:checked").length;
            if (len > 0) {
                $(button).removeAttr("disabled");
            } else {
                $(button).attr("disabled", true);
            }
        }

        //check is all selected
        function checkSelectedItems(type) {
            var all = $("input.select-all-" + type)[0];
            var total = $("input.select-item-" + type).length;
            var len = $("input.select-item-" + type + ":checked:checked").length;
            updateButtonStatus("#delete-" + type, "input.select-item-" + type);
            console.log("Selected " + type + ": " + len + "/" + total);
            all.checked = len === total;
        }

        // Deselect all checkboxes
        function deselectAllItems(type) {
            $("input.select-item-" + type).prop("checked", false);
        }

        //#endregion Generic Functions

        //#region Users

        // Button select/deselect all
        $("#select-all-users").click(function () {
            var all = $("input.select-all-users")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-users").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-users", "input.select-item-users");
        });

        //button select invert
        $("#select-invert-users").click(function () {
            $("input.select-item-users").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("users");
        });

        //column checkbox select all or cancel
        $("input.select-all-users").click(function () {
            var checked = this.checked;
            $("input.select-item-users").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-users", "input.select-item-users");
        });

        $("#delete-users").click(() => {
            var selectedItems = getSelectedItems("users");
            console.log("Selected Users:", selectedItems);
            deleteItems("users", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("User(s) deleted");
                deselectAllItems("users"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("users");
            });
        });

        //#endregion

        //#region Queues

        // Button select/deselect all
        $("#select-all-queues").click(function () {
            var all = $("input.select-all-queues")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-queues").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-queues", "input.select-item-queues");
        });

        //button select invert
        $("#select-invert-queues").click(function () {
            $("input.select-item-queues").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("queues");
        });

        //column checkbox select all or cancel
        $("input.select-all-queues").click(function () {
            var checked = this.checked;
            $("input.select-item-queues").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-queues", "input.select-item-queues");
        });

        $("#delete-queues").click(() => {
            var selectedItems = getSelectedItems("queues");
            console.log("Selected queues:", selectedItems);
            deleteItems("queues", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Queue(s) deleted");
                deselectAllItems("queues"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("queues");
            });
        });

        //#endregion

        //#region Skills

        // Button select/deselect all
        $("#select-all-skills").click(function () {
            var all = $("input.select-all-skills")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-skills").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-skills", "input.select-item-skills");
        });

        //button select invert
        $("#select-invert-skills").click(function () {
            $("input.select-item-skills").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("skills");
        });

        //column checkbox select all or cancel
        $("input.select-all-skills").click(function () {
            var checked = this.checked;
            $("input.select-item-skills").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-skills", "input.select-item-skills");
        });

        $("#delete-skills").click(() => {
            var selectedItems = getSelectedItems("skills");
            console.log("Selected skills:", selectedItems);
            deleteItems("skills", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Skill(s) deleted");
                deselectAllItems("skills"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("skills");
            });
        });

        //#endregion

        //#region Flows

        // Button select/deselect all
        $("#select-all-flows").click(function () {
            var all = $("input.select-all-flows")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-flows").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-flows", "input.select-item-flows");
        });

        //button select invert
        $("#select-invert-flows").click(function () {
            $("input.select-item-flows").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("flows");
        });

        //column checkbox select all or cancel
        $("input.select-all-flows").click(function () {
            var checked = this.checked;
            $("input.select-item-flows").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-flows", "input.select-item-flows");
        });

        $("#delete-flows").click(() => {
            var selectedItems = getSelectedItems("flows");
            console.log("Selected flows:", selectedItems);
            deleteItems("flows", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Flow(s) deleted");
                deselectAllItems("flows"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("flows");
            });
        });

        //#endregion

        //#region Presence Definitions

        // Button select/deselect all
        $("#select-all-presenceDefinitions").click(function () {
            var all = $("input.select-all-presenceDefinitions")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-presenceDefinitions").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-presenceDefinitions", "input.select-item-presenceDefinitions");
        });

        //button select invert
        $("#select-invert-presenceDefinitions").click(function () {
            $("input.select-item-presenceDefinitions").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("presenceDefinitions");
        });

        //column checkbox select all or cancel
        $("input.select-all-presenceDefinitions").click(function () {
            var checked = this.checked;
            $("input.select-item-presenceDefinitions").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-presenceDefinitions", "input.select-item-presenceDefinitions");
        });

        $("#delete-presenceDefinitions").click(() => {
            var selectedItems = getSelectedItems("presenceDefinitions");
            console.log("Selected presenceDefinitions:", selectedItems);
            deleteItems("presenceDefinitions", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Presence Definition(s) deleted");
                deselectAllItems("presenceDefinitions"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("presenceDefinitions");
            });
        });

        //#endregion

        //#region WrapUp Codes

        // Button select/deselect all
        $("#select-all-wrapupcodes").click(function () {
            var all = $("input.select-all-wrapupcodes")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-wrapupcodes").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-wrapupcodes", "input.select-item-wrapupcodes");
        });

        //button select invert
        $("#select-invert-wrapupcodes").click(function () {
            $("input.select-item-wrapupcodes").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("wrapupcodes");
        });

        //column checkbox select all or cancel
        $("input.select-all-wrapupcodes").click(function () {
            var checked = this.checked;
            $("input.select-item-wrapupcodes").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-wrapupcodes", "input.select-item-wrapupcodes");
        });

        $("#delete-wrapupcodes").click(() => {
            var selectedItems = getSelectedItems("wrapupcodes");
            console.log("Selected wrapupcodes:", selectedItems);
            deleteItems("wrapupcodes", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Wrap Up Code(s) deleted");
                deselectAllItems("wrapupcodes"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("wrapupcodes");
            });
        });

        //#endregion

        //#region Outbound Campaigns

        // Button select/deselect all
        $("#select-all-outboundCampaigns").click(function () {
            var all = $("input.select-all-outboundCampaigns")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-outboundCampaigns").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-outboundCampaigns", "input.select-item-outboundCampaigns");
        });

        //button select invert
        $("#select-invert-outboundCampaigns").click(function () {
            $("input.select-item-outboundCampaigns").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("outboundCampaigns");
        });

        //column checkbox select all or cancel
        $("input.select-all-outboundCampaigns").click(function () {
            var checked = this.checked;
            $("input.select-item-outboundCampaigns").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-outboundCampaigns", "input.select-item-outboundCampaigns");
        });

        $("#delete-outboundCampaigns").click(() => {
            var selectedItems = getSelectedItems("outboundCampaigns");
            console.log("Selected outboundCampaigns:", selectedItems);
            deleteItems("outboundCampaigns", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Outbound Campaign(s) deleted");
                deselectAllItems("outboundCampaigns"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("outboundCampaigns");
            });
        });

        //#endregion

        //#region Scripts

        // Button select/deselect all
        $("#select-all-scripts").click(function () {
            var all = $("input.select-all-scripts")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-scripts").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-scripts", "input.select-item-scripts");
        });

        //button select invert
        $("#select-invert-scripts").click(function () {
            $("input.select-item-scripts").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("scripts");
        });

        //column checkbox select all or cancel
        $("input.select-all-scripts").click(function () {
            var checked = this.checked;
            $("input.select-item-scripts").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-scripts", "input.select-item-scripts");
        });

        $("#delete-scripts").click(() => {
            var selectedItems = getSelectedItems("scripts");
            console.log("Selected scripts:", selectedItems);
            deleteItems("scripts", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Script(s) deleted");
                deselectAllItems("scripts"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("scripts");
            });
        });

        //#endregion

        //#region Web Chat Deployments

        // Button select/deselect all
        $("#select-all-webChatDeployments").click(function () {
            var all = $("input.select-all-webChatDeployments")[0];
            all.checked = !all.checked
            var checked = all.checked;
            $("input.select-item-webChatDeployments").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-webChatDeployments", "input.select-item-webChatDeployments");
        });

        //button select invert
        $("#select-invert-webChatDeployments").click(function () {
            $("input.select-item-webChatDeployments").each(function (index, item) {
                item.checked = !item.checked;
            });
            checkSelectedItems("webChatDeployments");
        });

        //column checkbox select all or cancel
        $("input.select-all-webChatDeployments").click(function () {
            var checked = this.checked;
            $("input.select-item-webChatDeployments").each(function (index, item) {
                item.checked = checked;
            });
            updateButtonStatus("#delete-webChatDeployments", "input.select-item-webChatDeployments");
        });

        $("#delete-webChatDeployments").click(() => {
            var selectedItems = getSelectedItems("webChatDeployments");
            console.log("Selected webChatDeployments:", selectedItems);
            deleteItems("webChatDeployments", selectedItems).then((response) => {
                console.log("Delete response:", response);
                showMessage("Web Chat Deployment(s) deleted");
                deselectAllItems("webChatDeployments"); //Otherwise, they will still count as selected after refresh
                loadObjects();
                checkSelectedItems("webChatDeployments");
            });
        });

        //#endregion

    </script>
</body>

</html>